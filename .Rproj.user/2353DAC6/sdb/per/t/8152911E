{
    "collab_server" : "",
    "contents" : "library(shiny)\nlibrary('xlsx')\n\nshinyServer(function(input, output) {\n  source(paste(getwd(), 'R/funkcja1.R', sep = \"/\"))\n  source(paste(getwd(), 'R/funkcja2.R', sep = \"/\"))\n\n\n  #Wybor genow referencyjnych\n  output$refgen<-renderUI({\n    \n    if (is.null(input$file2))\n      return(NULL)\n    \n    inFile2 <- input$file2\n    selectizeInput(\"refergene\",\n  label=\"Reference genes\", choices=read.xlsx(inFile2$datapath, header = T, 1)[, 1], multiple=T)\n    \n    })\n  \n  \n  #Obliczanie Fold difference\n  Fd <- reactive({\n    \n    if (input$configtype == \"Efficiency file\"){\n\n    Fd <- funkcja1(input$file1, input$file2, input$refergene)\n  \n    }else{\n      Fd <- funkcja2(input$file1, input$file2, input$refergene)\n    }\n    \n    Fd\n    })\n\n  #Macierz wynikowa\n  output$tabelka <- renderTable({\n    \n    if (is.null(input$file1) | is.null(input$file2) | is.null(input$refergene) | input$act == 0)\n      return(NULL)\n    \n    Fd()\n    \n  })\n\n\n#Boxplots for samples\n    output$patplot <- renderUI({\n      \n      if (is.null(input$file1) | is.null(input$file2) | is.null(input$refergene) | input$act == 0 | length(dim(Fd())) == 0)\n        return(NULL)\n      \n      \n\n    plot_output_1 <- lapply(1:dim(Fd())[1], function(i) {\n  output[[paste0('b', i)]] <- renderPlot({\n\n    y <- as.numeric(as.character(data.frame(lapply(Fd()[i, -c(1)], as.character), stringsAsFactors=FALSE)))\n    x <- data.matrix(Fd()[i, 1])\n    x <- rep(x, each = dim(Fd())[2]-1)\n    \n    \n      try(boxplot(y ~ x, outline = F, main = paste(c('Sample'), x[1], sep = ' ')), silent = T)\n\n  })\n})\n    plot_output_2 <- renderPlot({\n      \n      y <- as.numeric(as.character(data.frame(lapply(Fd()[, -c(1)], as.character), stringsAsFactors=FALSE)))\n      x <- data.matrix(Fd()[, 1])\n      x <- rep(x, each = dim(Fd())[2]-1)\n      \n      #boxplot(y ~ x, outline = F, main = c(\"Boxplot for all samples\"))\n      plot(length(y))\n      #!!!wydajnosci\n    })\n    \n    \n    plot_output_list <- c(plot_output_2, plot_output_1)\n    do.call(tagList, plot_output_list)\n\n   })\n\n    \n\n    \n    output$down <- downloadHandler(\n      filename=function() {\n      paste('wynik','.xlsx', sep='')\n    },\n    content = function(file){\n      write.xlsx(Fd(), file, row.names = F)\n      \n    })\n\n})\n",
    "created" : 1494497149426.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3332934936",
    "id" : "8152911E",
    "lastKnownWriteTime" : 1494581822,
    "last_content_update" : 1494581822022,
    "path" : "C:/Users/jakpo_000/Desktop/Nauka/Inzynierka/Program/thesis/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}